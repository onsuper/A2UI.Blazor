@inherits A2UIComponentBase

<div class="@GetCssClass()" style="@GetInlineStyle()">
    @if (!string.IsNullOrEmpty(EntryPointChildId))
    {
        <div @onclick="OpenModal">
            <A2UIRenderer SurfaceId="@SurfaceId" ComponentId="@EntryPointChildId" />
        </div>
    }

    @if (IsOpen && !string.IsNullOrEmpty(ContentChildId))
    {
        <div class="modal-overlay" @onclick="CloseModal" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); display: flex; align-items: center; justify-content: center; z-index: 1000;">
            <div class="modal-content" @onclick:stopPropagation style="background: white; padding: 24px; border-radius: 8px; max-width: 600px; max-height: 80vh; overflow: auto; position: relative;">
                <button @onclick="CloseModal" style="position: absolute; top: 12px; right: 12px; border: none; background: transparent; font-size: 24px; cursor: pointer; line-height: 1;">&times;</button>
                <A2UIRenderer SurfaceId="@SurfaceId" ComponentId="@ContentChildId" />
            </div>
        </div>
    }
</div>

@code {
    private string? EntryPointChildId;
    private string? ContentChildId;
    private bool IsOpen = false;

    protected override void OnParametersSet()
    {
        base.OnParametersSet();

        EntryPointChildId = GetStringProperty("entryPointChild");
        ContentChildId = GetStringProperty("contentChild");
    }

    private void OpenModal()
    {
        IsOpen = true;
        StateHasChanged();
    }

    private void CloseModal()
    {
        IsOpen = false;
        StateHasChanged();
    }

    protected override string GetCssClass()
    {
        return Theme.Components.Modal;
    }
}

